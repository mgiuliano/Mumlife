{% extends "base.html" %}

{% block bodyclass %}edit-mode manage-friends{% endblock %}

{% block heading %}<h1>Manage friends</h1>{% endblock %}

{% block content %}
    <section>

        <a href="{{ SITE_URL }}profile/edit" data-role="button" data-icon="arrow-l" data-iconpos="left">Back</a>

        {% comment %} Friends Requests {% endcomment %}
        {% if friend_requests %}
        <div data-role="collapsible">
            <h2>Friends Requests <span class="count">{{ friend_requests|length }}</span></h2>
            <ul data-role="listview">
                {% for friend in friend_requests %}
                    <li>
                        <div class="ui-grid-b">
                            <div class="ui-block-a">
                                <a href="{{ SITE_URL }}profile/{{ friend.slug }}">{{ friend.name }}</a>
                            </div>
                            <div class="ui-block-b">
                                <a class="addtofriend"
                                   href="#{{ account.id }},{{ friend.id }}"
                                   rel="confirm"
                                   data-role="button" data-icon="check" data-iconpos="right"><span>OK</span></a>
                            </div>
                            <div class="ui-block-c">
                                <a class="addtofriend"
                                   href="#{{ account.id }},{{ friend.id }}"
                                   rel="block"
                                   data-role="button" data-icon="delete" data-iconpos="right"><span>Block</span></a>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% comment %} Friends {% endcomment %}
        {% if friends %}
        <div data-role="collapsible">
            <h2>Friends <span class="count">{{ friends|length }}</span></h2>
            <ul data-role="listview">
                {% for friend in friends %}
                    <li>
                        <div class="ui-grid-a">
                            <div class="ui-block-a">
                                <a href="{{ SITE_URL }}profile/{{ friend.slug }}">{{ friend.fullname }}</a>
                            </div>
                            <div class="ui-block-c">
                                <a class="addtofriend"
                                   href="#{{ account.id }},{{ friend.id }}"
                                   rel="block"
                                   data-role="button" data-icon="delete" data-iconpos="right"><span>Block</span></a>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% comment %} Blocked Requests {% endcomment %}
        {% if blocked_requests %}
        <div data-role="collapsible">
            <h2>Blocked Requests <span class="count">{{ blocked_requests|length }}</span></h2>
            <ul data-role="listview">
                {% for friend in blocked_requests %}
                    <li>
                        <div class="ui-grid-a">
                            <div class="ui-block-a">
                                <a href="{{ SITE_URL }}profile/{{ friend.slug }}">{{ friend.name }}</a>
                            </div>
                            <div class="ui-block-b">
                                <a class="addtofriend"
                                   href="#{{ account.id }},{{ friend.id }}"
                                   data-role="button" data-icon="check" data-iconpos="right"><span>Add to Friend</span></a>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

    </section>
    <footer> </footer>
{% endblock %}

{% block extrajs %}{{ block.super }}
<script type="text/javascript">
    $(document).on('ml.Ready', function () {
        new ML.AddToFriends({'class': 'addtofriend'});
    });
</script>
{% endblock %}
